<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Álbum de Vales Navidad 2024</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,700&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #050505; color: white; }
        .font-serif { font-family: 'Playfair Display', serif; }
        .coupon-card { transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .custom-blur { backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- Indicador de Estado -->
    <div class="fixed top-4 right-4 z-50">
        <div id="sync-status" class="px-3 py-1.5 rounded-full text-[7px] font-black uppercase tracking-[0.2em] border bg-white/5 border-white/10 text-white/20">
            • Modo Local
        </div>
    </div>

    <header class="py-20 px-6 text-center relative">
        <div class="absolute top-0 left-1/2 -translate-x-1/2 w-64 h-64 bg-amber-500/10 blur-[100px] rounded-full"></div>
        <div class="relative z-10">
            <div class="text-amber-500 text-3xl mb-6">✨</div>
            <h1 class="text-5xl md:text-7xl font-serif font-bold tracking-tighter mb-4">
                Nuestro <span class="text-amber-500 italic">Álbum</span>
            </h1>
            <p class="text-white/20 text-[10px] uppercase tracking-[0.6em] font-light">Colección de Momentos 2024</p>
        </div>
    </header>

    <main id="coupons-grid" class="max-w-6xl mx-auto px-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 pb-32">
        <!-- Los vales se generarán con JS -->
    </main>

    <!-- Modal de Confirmación -->
    <div id="confirm-modal" class="fixed inset-0 z-[100] hidden items-center justify-center p-6 bg-black/90 custom-blur">
        <div class="bg-[#111] p-12 rounded-[3.5rem] border border-white/10 max-w-sm w-full text-center shadow-2xl">
            <div class="text-amber-500 text-4xl mb-6">⚠️</div>
            <h4 class="text-2xl font-bold mb-3 tracking-tighter text-white">¿Confirmar canje?</h4>
            <div class="flex flex-col gap-3 mt-8">
                <button id="btn-confirm" class="w-full bg-amber-500 text-black py-4 rounded-2xl font-black text-[10px] uppercase tracking-[0.2em]">Confirmar</button>
                <button id="btn-cancel" class="w-full py-4 text-white/30 font-bold text-[9px] uppercase tracking-widest">Cancelar</button>
            </div>
        </div>
    </div>

    <footer class="py-24 text-center opacity-20 border-t border-white/5">
        <p class="text-[8px] tracking-[0.6em] font-black uppercase">Navidad 2024 • Solo Para Ti</p>
    </footer>

    <script>
        const MAX_USES = 3;
        const coupons = [
            { id: 1, title: "Escapada de Ensueño", desc: "Fin de semana + 2 días al destino que tú elijas.", img: "https://images.unsplash.com/photo-1436491865332-7a61a109cc05?q=80&w=800" },
            { id: 2, title: "Ruta Puebliando", desc: "Viaje en bicicleta a un pueblo cercano. Aire puro.", img: "https://images.unsplash.com/photo-1470246973918-29a93221c455?q=80&w=800" },
            { id: 3, title: "Día de Pintura", desc: "Vino, lienzos y una tarde creando arte.", img: "https://images.unsplash.com/photo-1513364776144-60967b0f800f?q=80&w=800" },
            { id: 4, title: "Parque de Diversiones", desc: "Un día entero para gritar en las montañas rusas.", img: "https://images.unsplash.com/photo-1502675135487-e971002a6adb?q=80&w=800" },
            { id: 5, title: "Cita Romántica Deluxe", desc: "Cena espectacular y una noche inolvidable.", img: "https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b?q=80&w=800" },
            { id: 6, title: "Día de Spa Real", desc: "Masajes y desconexión total. Te lo mereces.", img: "https://images.unsplash.com/photo-1540555700478-4be289fbecef?q=80&w=800" },
            { id: 7, title: "Camping con Perritos", desc: "Fogata y estrellas con los peludos.", img: "https://images.unsplash.com/photo-1523906834658-6e24ef2386f9?q=80&w=800" },
            { id: 8, title: "Camping en Pareja", desc: "Fin de semana solo nosotros bajo las estrellas.", img: "https://images.unsplash.com/photo-1504280390367-361c6d9f38f4?q=80&w=800" },
            { id: 9, title: "Día de Gym en Pareja", desc: "Entrenamiento intenso y premio al terminar.", img: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=800" },
            { id: 10, title: "Curso de Baile", desc: "Aprender salsa o bachata. Risas aseguradas.", img: "https://images.unsplash.com/photo-1524594152303-9fd13543fe6e?q=80&w=800" }
        ];

        let state = JSON.parse(localStorage.getItem('vales_2024')) || {};
        let currentCouponId = null;

        function render() {
            const grid = document.getElementById('coupons-grid');
            grid.innerHTML = '';
            
            coupons.forEach(c => {
                const uses = state[c.id] || 0;
                const isFull = uses >= MAX_USES;
                const card = document.createElement('div');
                card.className = `coupon-card group bg-[#0a0a0a] rounded-[2.5rem] border border-white/5 overflow-hidden flex flex-col hover:border-amber-500/40`;
                
                card.innerHTML = `
                    <div class="h-48 relative overflow-hidden">
                        <img src="${c.img}" class="w-full h-full object-cover transition-all duration-1000 group-hover:scale-110 ${isFull ? 'grayscale opacity-20' : 'opacity-60'}">
                        <div class="absolute inset-0 bg-gradient-to-t from-[#0a0a0a] via-transparent"></div>
                        <div class="absolute top-6 right-6 bg-amber-500 text-black px-3 py-1 rounded-full text-[9px] font-black">${uses}/${MAX_USES}</div>
                    </div>
                    <div class="p-8 flex-1 flex flex-col">
                        <h3 class="text-white font-bold text-lg mb-2">${c.title}</h3>
                        <p class="text-neutral-500 text-[11px] mb-8 flex-1">${c.desc}</p>
                        <div class="space-y-3">
                            <div class="flex gap-2">
                                <button onclick="openModal(${c.id})" ${isFull ? 'disabled' : ''} class="flex-1 py-4 rounded-2xl font-bold text-[9px] uppercase tracking-widest transition-all ${isFull ? 'bg-neutral-900 text-neutral-700' : 'bg-white text-black hover:bg-amber-500'}">
                                    ${isFull ? 'Agotado' : 'Canjear'}
                                </button>
                                ${uses > 0 ? `<button onclick="undo(${c.id})" class="px-5 bg-white/5 rounded-2xl text-neutral-600 border border-white/5">↺</button>` : ''}
                            </div>
                            ${uses > 0 ? `<button onclick="agendar(${c.id})" id="cal-${c.id}" class="w-full py-3.5 bg-amber-500/5 text-amber-500 border border-amber-500/20 rounded-2xl text-[9px] font-bold uppercase tracking-widest">Agendar Cita</button>` : ''}
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        window.openModal = (id) => {
            currentCouponId = id;
            document.getElementById('confirm-modal').style.display = 'flex';
        };

        document.getElementById('btn-cancel').onclick = () => {
            document.getElementById('confirm-modal').style.display = 'none';
        };

        document.getElementById('btn-confirm').onclick = () => {
            if (currentCouponId) {
                state[currentCouponId] = (state[currentCouponId] || 0) + 1;
                localStorage.setItem('vales_2024', JSON.stringify(state));
                confetti({ particleCount: 150, spread: 60, origin: { y: 0.8 } });
                document.getElementById('confirm-modal').style.display = 'none';
                render();
            }
        };

        window.undo = (id) => {
            state[id] = Math.max(0, (state[id] || 0) - 1);
            localStorage.setItem('vales_2024', JSON.stringify(state));
            render();
        };

        window.agendar = (id) => {
            const c = coupons.find(x => x.id === id);
            const title = encodeURIComponent(`Cita: ${c.title} ❤️`);
            const url = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${title}`;
            
            const btn = document.getElementById(`cal-${id}`);
            const originalText = btn.innerText;
            
            // Copiar
            const el = document.createElement('textarea');
            el.value = url;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            
            btn.innerText = "¡Copiado! Pégalo si no abrió";
            btn.className = "w-full py-3.5 bg-emerald-500/10 text-emerald-500 border border-emerald-500/20 rounded-2xl text-[9px] font-bold uppercase tracking-widest";
            
            setTimeout(() => { render(); }, 3000);
            window.open(url, '_blank');
        };

        render();
    </script>
</body>
</html>

